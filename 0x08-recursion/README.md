Recursion stuff that need to be revised.
